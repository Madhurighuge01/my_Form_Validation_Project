<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<style type="text/css">
			.Form-action {
				border: solid 3px black;
				border-width: thick;
				border-width: 5px;
				padding: 50px;
				width: 500px;
				background-color: lightskyblue;
			}
		</style>
	</head>
	<body>
		<center>
		<div class="Form-action">
			<form onsubmit="return validation()" action="thankyou_page.html" method="get">
				Full Name:<input
					class="name"
					type="text"
					name="name"
					id="uname"
					placeholder="e.g.John D'souza"
					autofocus
				/><br />
				<p id="errorname" style="color:red"></p>

				Email:<input
					type="email"
					name="email"
					id="email"
					placeholder="e.g.your_email@example.com"
				/><br />
				<p id="erroremail" style="color: red"></p>

				Mobile No:<input
					type="text"
					name="mobile"
					id="mobile"
					value=""
					placeholder="e.g .(123)-456-7890"
					onkeydown="phoneNumberFormatter()"
				/><img id="img" src="" width="40px" height="40px" /><br>
				<span id="state" style="color:blueviolet;"></span>
				<br />
				<p id="errormobile" style="color: red"></p>

				<button type="submit" value="button" onclick="submitbtn(this.value)" style="background-color: tomato;">
					Submit
				</button>
				<span id="b1" style="font-style: italic; color: darkgreen"></span><br />
			</form>
		</div>
		</center>
		<script>
			const stateCodes = {
				100: "Andhra Pradesh",
				111: "Arunachal Pradesh",
				112: "Assam",
				113: "Bihar",
				114: "Chhattisgarh",
				115: "Goa",
				116: "Gujarat",
				117: "Haryana",
				118: "Himachal Pradesh",
				119: "Jammu and Kashmir",
				120: "Jharkhand",
				121: "Karnataka",
				122: "Kerala",
				123: "Madhya Pradesh",
				124: "Maharashtra",
				125: "Manipur",
				126: "Meghalaya",
				127: "Mizoram",
				128: "Nagaland",
				129: "Odisha",
				130: "Punjab",
				131: "Rajasthan",
				132: "Sikkim",
				133: "Tamil Nadu",
				134: "Telangana",
				135: "Tripura",
				136: "Uttarakhand",
				137: "Uttar Pradesh",
				138: "West Bengal",
				139: "Andaman and Nicobar Islands",
				140: "Chandigarh",
				141: "Dadra and Nagar Haveli",
				142: "Daman and Diu",
				143: "Delhi",
				144: "Lakshadweep",
				145: "Puducherry",
			};
			function formatPhoneNumber(value) {
				if (!value) return value;
				const phoneNumber = value.replace(/[^\d]/g, "");
				const phoneNumberLength = phoneNumber.length;
				const providerCode = phoneNumber.slice(0, 3);
				const stateCode = phoneNumber.slice(3, 6);
				providerImage(providerCode);
				stateCodeHandler(stateCode);

				if (phoneNumberLength < 4) return phoneNumber;
				if (phoneNumberLength < 7) {
					return `(${phoneNumber.slice(0, 3)}) ${phoneNumber.slice(3)}`;
				}
				return `(${phoneNumber.slice(0, 3)})-${phoneNumber.slice(
					3,
					6
				)}-${phoneNumber.slice(6, 9)}`;
			}

			function phoneNumberFormatter() {
				const inputField = document.getElementById("mobile");
				const formattedInputValue = formatPhoneNumber(inputField.value);
				inputField.value = formattedInputValue;
			}

			function providerImage(code) {
				const image = document.getElementById("img");
				if (code >= 621 && code <= 799) {
					// console.log("yes");
					image.setAttribute("src", "jio.png");
				}
				if (code >= 801 && code <= 920) {
					// console.log("yes");
					image.setAttribute("src", "idea.png");
				}
				if (code >= 921 && code <= 999) {
					// console.log("yes");
					image.setAttribute("src", "vodafone.png");
				}
			}

			function stateCodeHandler(stateCode) {
				// console.log(stateCode);
				const state = document.getElementById("state");
				for (const code of Object.keys(stateCodes)) {
					if (code == stateCode) {
						// console.log(code);
						let stateName = stateCodes[code];
						state.textContent = stateName;
					}
				}
			}
			function validation() {
				// event.preventDefault();
				var fullname = document.getElementById("uname").value;
				var email = document.getElementById("email").value;
				var mobile = document.getElementById("mobile").value;

				var usercheck = /^[a-zA-Z ]*$/;
				var emailcheck =
					/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
				var mobilecheck = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;

				if (!usercheck.test(fullname) || fullname == "") {
					document.getElementById("errorname").innerHTML =
						"**Full name is required**";
					return false;
				} else {
					document.getElementById("errorname").innerHTML = " ";
				}
				if (emailcheck.test(email)) {
					document.getElementById("erroremail").innerHTML = " ";
				} else {
					document.getElementById("erroremail").innerHTML =
						"* invalid email***";
					return false;
				}
				if (mobile == "" || !mobilecheck.test(mobile)) {
					document.getElementById("errormobile").innerHTML =
						"**invalid mobile number**";
					return false;
				} else {
					document.getElementById("errormobile").innerHTML = " ";
				}
				const otp = Math.floor(1000 + Math.random() * 9000);
				let dataObj = { name: fullname, email: email, phno: mobile, otp: otp };
				// let dataObj = { one: 1, two: 2 };
				localStorage.setItem("data", JSON.stringify(dataObj));
			}
			
		</script>
	</body>
</html>
